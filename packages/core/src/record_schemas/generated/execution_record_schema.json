{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "execution_record_schema.json",
  "title": "ExecutionRecord",
  "description": "Canonical schema for execution log records - the universal event stream.",
  "additionalProperties": false,
  "type": "object",
  "required": [
    "id",
    "taskId",
    "type",
    "title",
    "result"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^\\d{10}-exec-[a-z0-9-]{1,50}$",
      "maxLength": 66,
      "description": "Unique identifier for the execution log entry."
    },
    "taskId": {
      "type": "string",
      "pattern": "^\\d{10}-task-[a-z0-9-]{1,50}$",
      "maxLength": 66,
      "description": "ID of the parent task this execution belongs to."
    },
    "type": {
      "type": "string",
      "pattern": "^(analysis|progress|blocker|completion|info|correction|custom:[a-z0-9-]+)$",
      "description": "Semantic classification of the execution event. Standard types: analysis, progress, blocker, completion, info, correction. Custom types use the 'custom:' prefix (e.g. custom:deployment, custom:rollback). Implementations that encounter an unrecognized custom type must treat it as 'info'.\n"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 256,
      "description": "Human-readable title for the execution (used to generate ID slug)."
    },
    "result": {
      "type": "string",
      "minLength": 10,
      "description": "The tangible, verifiable output or result of the execution. This is the \"WHAT\" - evidence of work or event summary.\n"
    },
    "notes": {
      "type": "string",
      "description": "Optional narrative, context and decisions behind the execution. This is the \"HOW\" and \"WHY\" - the story behind the result.\n"
    },
    "references": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 500
      },
      "default": [],
      "description": "Optional list of typed references to relevant commits, files, PRs, or external documents. Standard prefixes: commit:, pr:, issue:, file:, url:, task:, exec:.\n"
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true,
      "description": "Optional structured data for machine consumption. Use this field for data that needs to be programmatically processed (e.g., audit findings, performance metrics, scan results). Complements result (WHAT) and notes (HOW/WHY) with structured, queryable data.\n"
    }
  }
}