{
  "header": {
    "version": "1.0",
    "type": "task",
    "payloadChecksum": "fedb5560a0491b2746224162387914576258a00dd6934bd0003e8edcbbc8fd4f",
    "signatures": [
      {
        "keyId": "human:camilo",
        "role": "author",
        "notes": "Signature regenerated by lint --fix",
        "signature": "VcWUDQ7u8rWX6hTJCIVNZ7Hcd3NeXtqtYTiO58Ld0b/iHDKwnKxB4u5YkJaYvGaNqr1LyTDPd7MBKABRaHDpBQ==",
        "timestamp": 1762658229
      },
      {
        "keyId": "human:camilo-v2",
        "role": "author",
        "notes": "Record signed",
        "signature": "qHwV5BAxMdZ4ph1tRaUH7J8hRAgLfZfMQ1IlYMxHZbg0+ZNcUxPKXF6yFEPjkMn6WN95E0TlLWmluZ8aa1I5BA==",
        "timestamp": 1763344809
      }
    ]
  },
  "payload": {
    "id": "1761604701-task-verificar-coherencia-completa-de-workflowmethodolo",
    "title": "Verify complete coherence of WorkflowMethodology: Protocol, Command, Adapter, Schema and Code",
    "status": "draft",
    "priority": "high",
    "description": "# Verificar coherencia completa de WorkflowMethodology: Protocol, Command, Adapter, Schema y Código\n\n## Contexto\n\nSiguiendo el proceso sistemático de revisión de 5 capas (agregamos verificación de schema) que aplicamos con `FeedbackAdapter`, ahora toca revisar el `WorkflowMethodologyAdapter`. Este es un protocolo fundamental que define las **reglas de transición de estados** para todas las tasks del sistema.\n\n**Nota crítica:** A diferencia de otros protocolos (Task, Execution, Feedback), WorkflowMethodology es un **protocolo de configuración** que permite diferentes implementaciones (DEFAULT, SCRUM, KANBAN, etc.).\n\n## Trabajo Previo Completado (Referencia Feedback)\n\nProceso de 5 capas aplicado exitosamente:\n\n### 1. Coherencia de Protocol + Documentos Adicionales con Command\n- ✅ Verificamos protocol + FAQ\n- ✅ Contrastamos con command\n- ✅ Identificamos inconsistencias\n- ✅ Actualizamos todos los documentos\n\n### 2. Coherencia de Protocol/Command con Adapter Blueprint\n- ✅ Revisamos adapter blueprint + FAQ\n- ✅ Verificamos que blueprint refleje protocol\n- ✅ Reescribimos secciones necesarias\n\n### 3. Coherencia de las 3 Capas\n- ✅ Verificación cruzada Protocol ↔ Command ↔ Adapter\n- ✅ EARS consistentes entre documentos\n\n### 4. Refactor de Implementación Real\n- ✅ Revisamos código del adapter\n- ✅ Refactorizamos según blueprint\n- ✅ Actualizamos tests\n- ✅ Verificamos coherencia arquitectural\n\n### 5. Verificación de Schema Generabilidad (NUEVO)\n- ✅ Verificamos que protocol puede generar schema completo\n- ✅ Usamos `task_protocol.md` como referencia\n- ✅ Confirmamos maxLength, patterns, enums completos\n\n## Objetivo de Esta Task\n\nAplicar el **proceso de 5 capas** a `WorkflowMethodology`:\n\n### Capa 1: Verificar Protocol ↔ Command (PENDIENTE)\n\n**Documentos a revisar:**\n- `packages/blueprints/03_products/protocol/10_workflow_methodology/workflow_methodology_protocol.md`\n- `packages/blueprints/03_products/protocol/10_workflow_methodology/workflow_methodology_protocol_faq.md` (si existe)\n- `packages/blueprints/03_products/cli/specs/workflow_command.md` (si existe)\n\n**Verificar:**\n- ❓ ¿Existe comando CLI `gitgov workflow`?\n- ❓ ¿Protocol define estructura clara de WorkflowMethodologyRecord?\n- ❓ ¿Hay ejemplos de configuraciones (DEFAULT, SCRUM)?\n- ❓ ¿State transitions definidas claramente?\n- ❓ ¿Guild-based validation documentada?\n\n### Capa 2: Verificar Protocol/Command ↔ Adapter Blueprint (PENDIENTE)\n\n**Documentos a revisar:**\n- `packages/blueprints/03_products/core/specs/adapters/workflow_methodology_adapter.md`\n- `packages/blueprints/03_products/core/specs/adapters/workflow_methodology_adapter_faq.md` (si existe)\n\n**Verificar:**\n- ❓ ¿Blueprint refleja protocol?\n- ❓ ¿Métodos documentados: `getTransitionRule()`, `validateSignature()`, etc.?\n- ❓ ¿EARS definidos y trazables?\n- ❓ ¿Describe configuraciones DEFAULT y SCRUM?\n\n### Capa 3: Verificar Coherencia 3 Capas (PENDIENTE)\n\n**Verificar:**\n- ❓ Protocol define transitions → ¿Adapter blueprint implementa validación?\n- ❓ Protocol define guild-based rules → ¿Command permite configurar?\n- ❓ Protocol define custom rules → ¿Adapter valida correctamente?\n- ❓ Ejemplos consistentes entre protocol/command/adapter\n\n### Capa 4: Verificar Código + Tests (PENDIENTE)\n\n**Archivos a revisar:**\n- `packages/core/src/adapters/workflow_methodology_adapter/index.ts`\n- `packages/core/src/adapters/workflow_methodology_adapter/workflow_methodology_adapter.test.ts`\n- `packages/core/src/adapters/workflow_methodology_adapter/workflow_methodology_adapter_integration.test.ts`\n- `packages/core/src/adapters/workflow_methodology_adapter/workflow_methodology_adapter_scrum_integration.test.ts`\n\n**Verificar:**\n- ❓ ¿Código implementa blueprint?\n- ❓ ¿Tests cubren EARS?\n- ❓ ¿Configuraciones DEFAULT y SCRUM funcionan?\n- ❓ ¿Guild-based validation funciona?\n- ❓ ¿Integration con BacklogAdapter coherente?\n- ❓ ¿Integration con FeedbackAdapter actualizada (6 métodos)?\n\n### Capa 5: Verificar Schema Generabilidad (NUEVO - CRÍTICO)\n\n**Usando `task_protocol.md` como referencia de calidad:**\n\n**Archivo:** `packages/blueprints/03_products/protocol/10_workflow_methodology/workflow_methodology_record_schema.yaml`\n\n**Verificar que protocol documenta:**\n- ❓ `maxLength` para todos los campos string\n- ❓ `pattern` para todos los IDs y enums\n- ❓ `minItems`/`maxItems` para arrays\n- ❓ `required` fields listados\n- ❓ `enum` values completos\n- ❓ `description` clara para cada campo\n\n**Luego verificar:**\n```bash\n# ¿Se puede generar schema desde protocol sin información faltante?\npnpm sync:schemas\npnpm compile:types\n# ¿Resultado: workflow_methodology_record.ts tiene todos los tipos correctos?\n```\n\n**Ejemplo de verificación (basado en task_protocol.md líneas 82-100):**\n```yaml\n# ✅ BUENO (como task_protocol.md):\nid:\n  type: string\n  pattern: \"^\\\\d{10}-workflow-[a-z0-9-]{1,50}$\"\n  maxLength: 70  # ← Especificado\n\n# ❌ MALO (info faltante):\nid:\n  type: string\n  pattern: \"^\\\\d{10}-workflow-[a-z0-9-]{1,50}$\"\n  # maxLength faltante! No se puede generar tipo preciso\n```\n\n## Alcance de Trabajo\n\n### 1. Revisión de Documentos\n\n**Protocol:**\n- Leer `workflow_methodology_protocol.md` completo\n- Verificar definición de state transitions\n- Verificar guild-based validation\n- Verificar custom rules\n\n**Command (si existe):**\n- ¿Hay `gitgov workflow` command?\n- ¿O solo se configura via archivos JSON/YAML?\n- Verificar coherencia con protocol\n\n**Adapter Blueprint:**\n- Verificar métodos documentados\n- Verificar EARS definidos\n- Verificar tabla trazabilidad\n\n**Schema:**\n- Verificar completitud usando task_protocol.md como estándar\n- Identificar campos sin maxLength/pattern\n- Verificar si se puede generar TypeScript preciso\n\n### 2. Revisión de Código\n\n**Archivos:**\n- `workflow_methodology_adapter/index.ts`\n- Tests (3 archivos)\n- Configuraciones: `workflow_methodology_default.json`, `workflow_methodology_scrum.json`\n\n**Verificar:**\n- ¿Implementa blueprint?\n- ¿Tests cubren EARS?\n- ¿Configuraciones coherentes con protocol?\n- ¿Integration con FeedbackAdapter actualizada (6 métodos)?\n- ¿Integration con BacklogAdapter correcta?\n\n### 3. Posibles Refactors\n\n- Actualizar referencias a FeedbackAdapter (6 métodos, no 5)\n- Actualizar configuraciones si protocol cambió\n- Agregar tests faltantes según EARS\n- Corregir validaciones si protocol define nuevas reglas\n\n## Deliverables\n\n1. ✅ Análisis de coherencia Protocol ↔ Command\n2. ✅ Análisis de coherencia con Adapter Blueprint\n3. ✅ Análisis de generabilidad del schema\n4. ✅ Lista de gaps encontrados\n5. ✅ Blueprint actualizado (si necesario)\n6. ✅ Schema actualizado con maxLength/patterns faltantes\n7. ✅ Código refactorizado (si necesario)\n8. ✅ Tests actualizados\n9. ✅ Verificación: todos los tests pasando\n\n## Criterios de Aceptación\n\n1. ✅ Protocol ↔ Command ↔ Adapter Blueprint 100% coherentes\n2. ✅ Schema puede generarse 100% desde protocol (sin info faltante)\n3. ✅ Código implementa exactamente el blueprint\n4. ✅ Tests cubren todos los EARS\n5. ✅ Configuraciones DEFAULT y SCRUM coherentes con protocol\n6. ✅ Guild-based validation funciona correctamente\n7. ✅ Integration con FeedbackAdapter actualizada (6 métodos)\n8. ✅ TypeScript sin errores\n9. ✅ Todos los tests del core siguen pasando\n\n## Referencias\n\n**Pendientes de revisar:**\n- `packages/blueprints/03_products/protocol/10_workflow_methodology/workflow_methodology_protocol.md`\n- `packages/blueprints/03_products/protocol/10_workflow_methodology/workflow_methodology_record_schema.yaml`\n- `packages/blueprints/03_products/core/specs/adapters/workflow_methodology_adapter.md`\n- `packages/core/src/adapters/workflow_methodology_adapter/index.ts`\n- Tests (3 archivos)\n\n**Referencia de calidad para schema:**\n- `packages/blueprints/03_products/protocol/04_task/task_protocol.md` (líneas 82-100)\n\n**Referencia de proceso exitoso:**\n- Task similar: FeedbackAdapter (5 capas, 23 archivos, 36 EARS, 742 tests)\n\n## Estimación\n\n**Complejidad:** Media (principalmente verificación, posibles ajustes menores)\n**Tiempo estimado:** 6-8 horas (si no hay refactors grandes)\n**Prioridad:** High (protocolo fundamental para todo el sistema de tasks)\n**Riesgo:** Bajo-Medio (configuraciones ya funcionan en producción)\n**Tags:** `core`, `workflow-methodology`, `coherence-verification`, `schema-validation`, `protocol-sync`",
    "tags": [
      "core",
      "workflow-methodology",
      "coherence-verification",
      "schema-validation",
      "protocol-sync"
    ],
    "references": [],
    "cycleIds": [
      "1763344784-cycle-tareas-hurfanas-consolidadas"
    ]
  }
}