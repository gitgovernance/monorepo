{
  "header": {
    "version": "1.0",
    "type": "task",
    "payloadChecksum": "011c23a02ca0a39c71cd8dba3460ff01dbfb226b7df965dd7fa7f685311fa2fa",
    "signatures": [
      {
        "keyId": "human:camilo-v2",
        "role": "author",
        "notes": "Record signed",
        "signature": "76rDR8Bq2Jw17JOqHQ37WEKbTGX1dCm6A4iWSKMYRhofNLy4EJrno4E1WXAyLSR+4mGdI7CanTTe2RqyC4gtCw==",
        "timestamp": 1763345092
      },
      {
        "keyId": "human:camilo-v2",
        "role": "author",
        "notes": "Record signed",
        "signature": "AUeG3o/yNhe9o82pbBJJ1buMF+nGanL/Xd5/LTipzryZ+Dx+WXY28fKrxYMV/FIShvb3uqijifflIvpUxgAhCA==",
        "timestamp": 1763345092
      }
    ]
  },
  "payload": {
    "id": "1763345092-task-implement-multi-machine-collaboration-system-for-g",
    "title": "Implement Multi-machine Collaboration System for GitGovernance",
    "status": "draft",
    "priority": "critical",
    "description": "# Multi-machine Collaboration System for GitGovernance\\n\\n## Epic Vision\\n\\nImplement a **3-layer collaboration system** enabling teams to work together on GitGovernance in real-time while maintaining data sovereignty and offline-first principles.\\n\\n### Collaboration Layers\\n\\n1. **EventBus** (in-memory, same process) - âœ… Already implemented (32 tests passing)\\n2. **LocalSyncModule** (cross-process, same machine) - File watchers with chokidar\\n3. **SyncModule** (cross-machine, N developers) - Git push/pull on orphan gitgov-state branch\\n\\n## Epic Scope\\n\\n### Core Modules\\n\\n- SyncModule: Main orchestrator for cross-machine synchronization\\n- GitModule: Low-level Git operations (push, pull, rebase, checkout)\\n- LocalSyncModule: File watchers and cross-process synchronization\\n\\n### CLI Commands\\n\\n-  - Push local state to gitgov-state branch\\n-  - Pull remote changes from gitgov-state branch\\n-  - Governed conflict resolution ceremony with cryptographic signatures\\n-  - Complete state integrity verification\\n\\n### Auto-Sync Features\\n\\n- **Immediate Strategy**: Auto-push after each Record-modifying operation\\n- **PullScheduler**: Automatic periodic pull (default: every 2 minutes)\\n- **Configurable**: Via .gitgov/config.json and .session.json\\n\\n### Integration Points\\n\\n- ProjectAdapter Integration: SyncModule.ensureStateBranch() in ProjectAdapter.initializeProject()\\n- CLI init: gitgov init will create gitgov-state branch automatically\\n- Adapters: Auto-sync in BacklogAdapter, FeedbackAdapter, etc.\\n\\n## Implementation Plan\\n\\n**Duration**: 6-8 weeks\\n**Cycles**: 9 cycles (Cycle 00-08)\\n**Tasks**: 43 atomic tasks\\n**Files**: ~33 files (8 specs .md, 17 implementation .ts, 7 tests .test.ts)\\n\\n### Cycle Status\\n\\n- Cycle 00 (Setup & Documentation): âœ… Completed\\n- Cycle 1 (SyncModule Basic - Manual Sync): ðŸ”µ In Progress\\n- Cycle 2 (Local Sync - File Watchers): âšª Pending\\n- Cycle 3 (Dashboard Integration): âšª Pending\\n- Cycle 4 (Conflict Resolution): âšª Pending\\n- Cycle 5 (Auto-Sync - Immediate Strategy): âšª Pending\\n- Cycle 6 (Pull Scheduler - Auto-Pull): âšª Pending\\n- Cycle 7 (Quality & Polish): âšª Pending\\n- Cycle 8 (Documentation & Release): âšª Pending\\n\\n### Critical Dependencies\\n\\nEventBus â†’ GitModule â†’ SyncModule â†’ LocalSyncModule â†’ CLI Commands\\n\\n**Build Order**: GitModule MUST be implemented before SyncModule\\n\\n## Success Criteria\\n\\n### Coverage Targets\\n\\n- EventBus: âœ… 100% (COMPLETED - 32/32 tests)\\n- GitModule: â‰¥80% (ðŸ”µ ~60% currently)\\n- LocalSyncModule: â‰¥80% (ðŸ”µ ~40% currently)\\n- SyncModule: â‰¥85% (âšª Pending)\\n\\n### E2E Tests (6 mandatory scenarios)\\n\\n1. Push-Pull Cycle: User A creates task â†’ pushes â†’ User B pulls â†’ sees task\\n2. Conflict Resolution: Both users edit same task â†’ conflict â†’ ceremony â†’ resolved\\n3. Multi-User Collaboration: 2+ users working simultaneously\\n4. Auto-Sync: createTask() auto-pushes in background\\n5. Dashboard Updates: Dashboard auto-pulls every 2 minutes\\n6. Performance Load: 100+ tasks, multiple users, <5s operations\\n\\n### Performance Targets\\n\\n- sync push: <5s (no conflicts)\\n- sync pull: <3s (no conflicts)\\n- sync resolve: <2s\\n- EventBus propagation: <100ms âœ… (already achieved)\\n- File watcher debounce: <500ms\\n- Dashboard update latency: <200ms\\n\\n## Key Risks & Mitigations\\n\\n| Risk | Probability | Impact | Severity | Mitigation |\\n|------|-------------|--------|----------|------------|\\n| Git Rebase Conflicts | High (30%) | High | ðŸ”´ High | Pull-Before-Push policy, verifyIntegrity(), clear wizard |\\n| Sync Latency | High (40%) | Medium | ðŸŸ¡ Medium | Pull scheduler (2m), reduce interval, visual indicators |\\n| Frequent Conflicts | Medium (20%) | High | ðŸŸ¡ Medium | Auto-pull every 2m, clear UI, governed ceremony |\\n| Network Failures | Low (10%) | Medium | ðŸŸ¢ Low | Retry 3x with exponential backoff, 30s timeout |\\n\\n## Architecture Decisions\\n\\n### gitgov-state as Orphan Branch\\n\\nUse a separate orphan Git branch for shared team state.\\n\\n**Reasons**:\\n- Data sovereignty (everything in Git, no external DB)\\n- Offline-first (works without internet)\\n- Simplicity (Git already solved distributed sync)\\n- Audit trail (complete cryptographically signed history)\\n\\n### Sync Strategies\\n\\n- manual: Individual development, explicit push/pull commands\\n- immediate: Small teams (<10), auto-push after each operation, periodic pull (2m)\\n- batched: Large teams, grouped pushes every N minutes (Post-MVP)\\n\\n### Actor-Specific Sync Status\\n\\nEach actor has their own syncStatus in .session.json with lastSyncPush, lastSyncPull, and status (synced/pushing/pulling/conflict)\\n\\n## Critical Implementation Details\\n\\n### pushState() - 9 Phase Pipeline\\n\\n1. Pre-flight Checks: Verify no rebase in progress, gitgov-state exists\\n2. Integrity Verification: Check all checksums and signatures\\n3. Save Current Branch: Store current branch for rollback\\n4. Switch to gitgov-state: git checkout gitgov-state\\n5. Pull Remote Changes: git pull --rebase (Pull-Before-Push)\\n6. Stage Local Changes: git add .gitgov/\\n7. Create Commit: git commit with actor and timestamp\\n8. Push to Remote: git push (retry up to 3x on rejection)\\n9. Return to Original Branch: git checkout + emit event\\n\\n**Retry Logic**: If push rejected (race condition), pull and retry (max 3 attempts)\\n\\n### pullState() - 6 Phase Pipeline\\n\\n1. Pre-flight Checks: No rebase in progress, branch exists\\n2. Save Current Branch: For rollback\\n3. Switch to gitgov-state: git checkout gitgov-state\\n4. Pull Remote Changes: git pull --rebase\\n5. Copy .gitgov/ to Work Branch: git checkout <branch> -- .gitgov/\\n6. Return & Re-index: Switch back + indexer.rebuild() + emit event\\n\\n### resolveConflict() - Governed Ceremony\\n\\n1. Verify rebase in progress\\n2. Validate all conflicts resolved\\n3. Continue rebase (Git creates rebase commit)\\n4. Create resolution commit with cryptographic signature (reason, actor ID, Ed25519 signature, timestamp)\\n\\n**Audit Trail**: All resolutions are cryptographically signed and auditable via git log\\n\\n### File Watcher Debouncing\\n\\n300ms debounce to prevent duplicate events. If file changes multiple times in 300ms, emit ONE event at the end.\\n\\n## Documentation References\\n\\nThis epic is documented across 4 files:\\n\\n1. roadmap.md - Strategic vision, architecture decisions, risks, cycles\\n2. implementation_plan.md - Detailed task breakdown, EARS distribution, traceability\\n3. test_specifications.md - Test cases, coverage requirements, E2E scenarios\\n4. implementation_guide.md - Complete algorithms, troubleshooting guide, technical details\\n\\n## Next Steps\\n\\n1. Complete GitModule implementation (Task 1.0) - PREREQUISITE\\n2. Implement SyncModule core (Task 1.1) - Depends on GitModule\\n3. Implement config & validation (Task 1.2)\\n4. Implement CLI commands (Task 1.3)\\n5. Create unit tests (Task 1.4)\\n6. CRITICAL: Integrate SyncModule in ProjectAdapter (Task 1.5)\\n\\nWithout Task 1.5, gitgov init will never create gitgov-state branch automatically!\\n\\n## Current Progress\\n\\n- Epic Status: ðŸ”µ IN PROGRESS (25% completed)\\n- Completed: EventBus (100%), Documentation (100%)\\n- In Progress: GitModule (~60%), LocalSyncModule (~40%)\\n- Pending: SyncModule, CLI Commands, Adapters, Tests E2E\\n\\n**Total Tasks**: 43 tasks across 9 cycles  \\n**Estimated Duration**: 6-8 weeks  \\n**Team Size**: Flexible (designed for solo or small teams)",
    "tags": [
      "epic:collaboration-system",
      "category:feature",
      "package:core",
      "package:cli",
      "skill:typescript",
      "skill:git",
      "skill:architecture"
    ],
    "cycleIds": [
      "1763344302-cycle-epic-multi-machine-collaboration-system"
    ],
    "references": [
      "file:packages/blueprints/03_products/epics/collaboration_system/roadmap.md",
      "file:packages/blueprints/03_products/epics/collaboration_system/implementation_plan.md",
      "file:packages/blueprints/03_products/epics/collaboration_system/test_specifications.md",
      "file:packages/blueprints/03_products/epics/collaboration_system/implementation_guide.md"
    ]
  }
}