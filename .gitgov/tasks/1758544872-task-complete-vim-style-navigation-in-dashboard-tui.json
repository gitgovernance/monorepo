{
  "header": {
    "version": "1.0",
    "type": "task",
    "payloadChecksum": "159224058812032ff422285c72589b3bbfe71c360844c61e0cd36a8780a8f5d2",
    "signatures": [
      {
        "keyId": "human:camilo",
        "role": "author",
        "notes": "Signature regenerated by lint --fix",
        "signature": "BagtCawM86Pj8+N8qLkq7Cw2KofHIlP8Pa52pdVJ2e/sAR1kFzTTvJ3c5XpfeG7SSL23yzpIdy9xi68PTOppCg==",
        "timestamp": 1762658229
      }
    ]
  },
  "payload": {
    "id": "1758544872-task-complete-vim-style-navigation-in-dashboard-tui",
    "title": "Add task selection to dashboard",
    "status": "done",
    "priority": "high",
    "description": "**WIP COMPLETION TASK**: Implement task selection and highlighting in Dashboard TUI with keyboard navigation.\n\n## üéØ CORE FEATURE: Task Selection & Highlighting\n\n**What we're building:** The ability to select and highlight individual tasks in the dashboard using keyboard navigation (j/k/arrows), with clear visual feedback showing which task is currently selected.\n\n## üö® CURRENT STATE (WIP - Work In Progress)\n\n**What's Already Implemented:**\n- ‚úÖ Basic keyboard handling infrastructure (useInput hook)\n- ‚úÖ View switching: `v`, `1-4` keys work\n- ‚úÖ Basic controls: `q` (quit), `?` (help), `r` (refresh), `s` (sort)\n- ‚úÖ Three dashboard views: Row-based, Kanban, Scrum\n\n**What's Missing (WIP State):**\n- ‚ùå **Task Selection State**: No way to select individual tasks\n- ‚ùå **Visual Highlighting**: No indication of which task is currently selected\n- ‚ùå **Keyboard Navigation**: Can't move between tasks with keyboard\n- ‚ùå **Selection Logic**: No navigation between tasks in any view\n\n## üìã IMPLEMENTATION REQUIREMENTS\n\n### **COMPONENT 1: Selection State Management**\n\nAdd task selection state to DashboardTUI component:\n```typescript\nconst [selectedIndex, setSelectedIndex] = useState<number>(-1); // -1 = no selection\nconst [selectedTaskId, setSelectedTaskId] = useState<string | null>(null);\n```\n\n### **COMPONENT 2: Keyboard Navigation**\n\nAdd keyboard handlers for task navigation:\n```typescript\n// Add to existing switch statement in useInput (line ~241)\ncase 'j':\ncase 'ArrowDown':\n  // Move selection down\n  navigateDown();\n  break;\ncase 'k': \ncase 'ArrowUp':\n  // Move selection up\n  navigateUp();\n  break;\ncase 'g':\n  // Go to first task\n  setSelectedIndex(0);\n  break;\ncase 'G':\n  // Go to last task  \n  setSelectedIndex(sortedTasks.length - 1);\n  break;\n```\n\n### **COMPONENT 3: Navigation Logic Functions**\n\nImplement navigation functions:\n```typescript\nconst navigateDown = () => {\n  const maxIndex = sortedTasks.length - 1;\n  setSelectedIndex(prev => {\n    if (prev === -1) return 0; // First navigation selects first item\n    return prev >= maxIndex ? maxIndex : prev + 1; // Don't go past end\n  });\n};\n\nconst navigateUp = () => {\n  setSelectedIndex(prev => {\n    if (prev === -1) return 0; // First navigation selects first item  \n    return prev <= 0 ? 0 : prev - 1; // Don't go past beginning\n  });\n};\n```\n\n### **COMPONENT 4: Visual Highlighting (CORE FEATURE)**\n\nUpdate task rendering in all three views to highlight selected task:\n\n**Row View Enhancement:**\n```typescript\n// In RowView, modify task rendering to highlight selected\nconst isSelected = index === selectedIndex;\nconst backgroundColor = isSelected ? 'blue' : undefined;\nconst color = isSelected ? 'white' : undefined;\n\n<Cell \n  text={task.title} \n  width={titleWidth}\n  backgroundColor={backgroundColor}\n  color={color}\n/>\n```\n\n**Kanban View Enhancement:**\n```typescript\n// Add selection highlighting to kanban cards\nconst taskIndex = sortedTasks.findIndex(t => t.id === task.id);\nconst isSelected = taskIndex === selectedIndex;\n```\n\n**Scrum View Enhancement:**\n```typescript\n// Add selection highlighting to scrum board items\nconst taskIndex = sortedTasks.findIndex(t => t.id === task.id);  \nconst isSelected = taskIndex === selectedIndex;\n```\n\n### **COMPONENT 5: Selection Persistence**\n\nMaintain selection across view changes and refreshes:\n```typescript\n// Update selectedTaskId when selectedIndex changes\nuseEffect(() => {\n  if (selectedIndex >= 0 && selectedIndex < sortedTasks.length) {\n    setSelectedTaskId(sortedTasks[selectedIndex].id);\n  } else {\n    setSelectedTaskId(null);\n  }\n}, [selectedIndex, sortedTasks]);\n\n// Restore selection when tasks change\nuseEffect(() => {\n  if (selectedTaskId) {\n    const newIndex = sortedTasks.findIndex(task => task.id === selectedTaskId);\n    if (newIndex >= 0) {\n      setSelectedIndex(newIndex);\n    }\n  }\n}, [sortedTasks, selectedTaskId]);\n```\n\n## üìä ACCEPTANCE CRITERIA\n\n### **Selection & Highlighting (CORE FUNCTIONALITY)**\n1. ‚úÖ **Initial State**: Dashboard starts with no task selected (selectedIndex = -1)\n2. ‚úÖ **Visual Highlighting**: Selected task has blue background + white text\n3. ‚úÖ **Clear Indication**: Only one task highlighted at a time\n4. ‚úÖ **Works in All Views**: Selection visible in Row, Kanban, and Scrum views\n\n### **Keyboard Navigation**\n5. ‚úÖ **First Navigation**: Pressing `j`, `k`, `‚Üë`, or `‚Üì` selects first task\n6. ‚úÖ **Down Navigation**: `j` and `‚Üì` move selection down, stop at last task\n7. ‚úÖ **Up Navigation**: `k` and `‚Üë` move selection up, stop at first task  \n8. ‚úÖ **Jump to Start**: `g` selects first task immediately\n9. ‚úÖ **Jump to End**: `G` selects last task immediately\n\n### **State Management**  \n10. ‚úÖ **Persist Across Views**: Selection maintained when switching between views (`v`, `1-4`)\n11. ‚úÖ **Persist Across Refresh**: Selection maintained when refreshing (`r`)\n12. ‚úÖ **Persist Across Sort**: Selection follows task when sort mode changes (`s`)\n\n### **Edge Cases**\n13. ‚úÖ **Empty List**: Navigation gracefully handles empty task list\n14. ‚úÖ **Single Task**: Navigation works correctly with only one task\n15. ‚úÖ **Boundary Conditions**: Can't navigate past first/last task\n\n## üéØ IMPLEMENTATION SCOPE\n\n### **IN SCOPE (This Task)**\n- ‚úÖ Task selection state management (selectedIndex, selectedTaskId)\n- ‚úÖ Visual highlighting of selected task (blue background + white text)\n- ‚úÖ Keyboard navigation (j, k, ‚Üë, ‚Üì, g, G)\n- ‚úÖ Navigation logic with boundary handling\n- ‚úÖ Selection persistence across views/refresh/sort\n\n### **OUT OF SCOPE (Future Tasks)**\n- ‚ùå Actions on selected task (Enter, d, e, a)\n- ‚ùå Search mode (/) \n- ‚ùå Cycle view switching (c, t)\n- ‚ùå Task details modal\n- ‚ùå Edit/delete/assign functionality\n\n## üß™ TESTING REQUIREMENTS\n\n### **Manual Testing Checklist**\n1. **Start dashboard** ‚Üí No task selected initially\n2. **Press `j`** ‚Üí First task highlighted with blue background\n3. **Press `j` multiple times** ‚Üí Selection moves down, stops at end\n4. **Press `k` multiple times** ‚Üí Selection moves up, stops at start\n5. **Press `g`** ‚Üí Jumps to first task\n6. **Press `G`** ‚Üí Jumps to last task\n7. **Switch views (`v`)** ‚Üí Selection maintained and visible\n8. **Refresh (`r`)** ‚Üí Selection maintained  \n9. **Change sort (`s`)** ‚Üí Selection follows task\n\n### **Visual Verification**\n- Selected task has blue background + white text\n- Only one task highlighted at a time\n- Highlighting works in Row, Kanban, and Scrum views\n- Clear visual distinction between selected and unselected tasks\n\n## üìÅ FILES TO MODIFY\n\n1. **`packages/cli/src/components/dashboard/DashboardTUI.tsx`**\n   - Add selection state (selectedIndex, selectedTaskId)\n   - Add keyboard navigation handlers\n   - Add navigation functions (navigateUp, navigateDown)\n   - Add selection persistence logic\n\n2. **Update all three view components:**\n   - **RowView**: Add highlighting to task rows\n   - **KanbanView**: Add highlighting to kanban cards\n   - **ScrumView**: Add highlighting to scrum items\n\n## üö® CRITICAL NOTES\n\n- **This completes a WIP feature** - basic infrastructure exists but selection/highlighting is missing\n- **Visual highlighting is the core feature** - users need to see which task is selected\n- **Must work across all 3 dashboard views** (Row, Kanban, Scrum)\n- **Selection state must persist** across view changes and refreshes\n- **Keyboard navigation is the interaction method** but highlighting is the main feature\n\n## üîó REFERENCES\n\n- **Current Implementation**: `packages/cli/src/components/dashboard/DashboardTUI.tsx` lines 241-318\n- **Blueprint Specification**: `packages/blueprints/03_products/cli/specs/dashboard_command.md` section 3.4\n- **Navigation Keys**: Lines 294-297 in blueprint (currently marked ‚ùå)\n\nThis task **implements task selection and highlighting** with keyboard navigation as the interaction method.\n\n\n> Implementation note: Consider refactoring RowView into a reusable SelectionTable component so cycles or other entities can reuse navigation + highlight.",
    "tags": [
      "wip",
      "keyboard",
      "tui",
      "dashboard",
      "ux",
      "completion",
      "selection",
      "highlighting"
    ],
    "cycleIds": [
      "1758521424-cycle-week-1-sep-22-28"
    ],
    "references": []
  }
}